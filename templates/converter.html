{% set scale = scale_factor|default(1) -%}
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SVG to PNG converter - {{ output_filename|e }}</title>
</head>
<body>
  <canvas width="{{ width * scale }}" height="{{ height * scale }}"></canvas>
  <script>
    var canvas = document.querySelector('canvas');
    var context = canvas.getContext('2d');
    context.scale({{ scale }}, {{ scale }});
    var img = new Image;
    img.onload = function () {
      context.drawImage(img, 0, 0);
      canvas.toBlob(function (blob) {
        var newImg = new Image;
        var imgURL = URL.createObjectURL(blob);
        newImg.style.display = 'block';
        newImg.style.maxHeight = '100vh';
        newImg.style.maxWidth = '100vw';
        newImg.onload = function () {
          var a = document.createElement('a');
          a.href = imgURL;
          a.download = '{{ output_filename|e }}';
          a.click();
          a.removeAttribute('download');
          a.appendChild(newImg);
          canvas.style.display = 'none';
          document.body.appendChild(a);
        };
        newImg.src = imgURL;
      });
    };
    img.src = 'data:image/svg+xml;base64,' + '{{ svg|b64encode }}';
  </script>
</body>
</html>
